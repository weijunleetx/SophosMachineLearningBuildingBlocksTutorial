C:\Users\weijunlee\Desktop\SophosMachineLearningBuildingBlocksTutorial-master>python urlmodel.py compare --filepath data --n 100000

Using TensorFlow backend.
06/27/2018 08:14:31 PM __main__     INFO     Importing clean URLs
06/27/2018 08:14:32 PM __main__     INFO     Importing dirty URLs
06/27/2018 08:14:32 PM __main__     INFO     Max dirty urls = 62286
06/27/2018 08:14:32 PM __main__     INFO     Dirty samples: 62286
06/27/2018 08:14:32 PM __main__     INFO     Clean samples: 436002
06/27/2018 08:14:38 PM __main__     INFO     MMH3-hashing feature vectors...
06/27/2018 08:16:12 PM __main__     INFO     MMH3-hashed data samples: 498288
06/27/2018 08:17:37 PM __main__     INFO     Constructing model - deep
06/27/2018 08:17:39 PM __main__     INFO     Constructed model:
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_1 (Dense)              (None, 128)               384128
_________________________________________________________________
batch_normalization_1 (Batch (None, 128)               512
_________________________________________________________________
activation_1 (Activation)    (None, 128)               0
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0
_________________________________________________________________
dense_2 (Dense)              (None, 64)                8256
_________________________________________________________________
batch_normalization_2 (Batch (None, 64)                256
_________________________________________________________________
activation_2 (Activation)    (None, 64)                0
_________________________________________________________________
dropout_2 (Dropout)          (None, 64)                0
_________________________________________________________________
dense_3 (Dense)              (None, 64)                4160
_________________________________________________________________
batch_normalization_3 (Batch (None, 64)                256
_________________________________________________________________
activation_3 (Activation)    (None, 64)                0
_________________________________________________________________
dropout_3 (Dropout)          (None, 64)                0
_________________________________________________________________
dense_4 (Dense)              (None, 32)                2080
_________________________________________________________________
batch_normalization_4 (Batch (None, 32)                128
_________________________________________________________________
activation_4 (Activation)    (None, 32)                0
_________________________________________________________________
dropout_4 (Dropout)          (None, 32)                0
_________________________________________________________________
dense_5 (Dense)              (None, 1)                 33
=================================================================
Total params: 399,809
Trainable params: 399,233
Non-trainable params: 576
_________________________________________________________________
06/27/2018 08:17:39 PM __main__     INFO     Start training model...
Epoch 1/20
326034/326034 [==============================] - 43s 131us/step - loss: 0.3287 - acc: 0.8856
Epoch 2/20
326034/326034 [==============================] - 28s 87us/step - loss: 0.2771 - acc: 0.9027
Epoch 3/20
326034/326034 [==============================] - 27s 82us/step - loss: 0.2576 - acc: 0.9097
Epoch 4/20
326034/326034 [==============================] - 27s 81us/step - loss: 0.2446 - acc: 0.9144
Epoch 5/20
326034/326034 [==============================] - 27s 81us/step - loss: 0.2335 - acc: 0.9184
Epoch 6/20
326034/326034 [==============================] - 27s 82us/step - loss: 0.2249 - acc: 0.9213
Epoch 7/20
326034/326034 [==============================] - 27s 83us/step - loss: 0.2167 - acc: 0.9241                                         Epoch 8/20
326034/326034 [==============================] - 27s 82us/step - loss: 0.2080 - acc: 0.9273
Epoch 9/20
326034/326034 [==============================] - 26s 80us/step - loss: 0.2019 - acc: 0.9292
Epoch 10/20
326034/326034 [==============================] - 26s 80us/step - loss: 0.1955 - acc: 0.9316                                         Epoch 11/20
326034/326034 [==============================] - 28s 87us/step - loss: 0.1887 - acc: 0.9338
Epoch 12/20
326034/326034 [==============================] - 27s 84us/step - loss: 0.1832 - acc: 0.9356
Epoch 13/20
326034/326034 [==============================] - 28s 87us/step - loss: 0.1771 - acc: 0.9374
Epoch 14/20
326034/326034 [==============================] - 26s 81us/step - loss: 0.1710 - acc: 0.9398
Epoch 15/20
326034/326034 [==============================] - 26s 80us/step - loss: 0.1646 - acc: 0.9418
Epoch 16/20
326034/326034 [==============================] - 26s 80us/step - loss: 0.1593 - acc: 0.9431
Epoch 17/20
326034/326034 [==============================] - 26s 79us/step - loss: 0.1547 - acc: 0.9450
Epoch 18/20
326034/326034 [==============================] - 26s 79us/step - loss: 0.1494 - acc: 0.9467
Epoch 19/20
326034/326034 [==============================] - 26s 80us/step - loss: 0.1427 - acc: 0.9493
Epoch 20/20
326034/326034 [==============================] - 26s 80us/step - loss: 0.1390 - acc: 0.9503
06/27/2018 08:26:51 PM __main__     INFO     Predicting test dataset... deep
06/27/2018 08:27:04 PM __main__     INFO     AUC = [0.9647627882575132]
06/27/2018 08:27:04 PM __main__     INFO     Plotting results for deep model @ data\deepmodel_timesplit
C:\Program Files\Python36\lib\site-packages\matplotlib\tight_layout.py:207: UserWarning: tight_layout : falling back to Agg renderer
  warnings.warn("tight_layout : falling back to Agg renderer")
06/27/2018 08:27:06 PM __main__     INFO     Constructing model - shallow
06/27/2018 08:27:07 PM __main__     INFO     Constructed model:
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_6 (Dense)              (None, 1)                 3001
=================================================================
Total params: 3,001
Trainable params: 3,001
Non-trainable params: 0
_________________________________________________________________
06/27/2018 08:27:07 PM __main__     INFO     Start training model...
Epoch 1/20
326034/326034 [==============================] - 14s 44us/step - loss: 0.3753 - acc: 0.8758
Epoch 2/20
326034/326034 [==============================] - 7s 23us/step - loss: 0.3270 - acc: 0.8829
Epoch 3/20
326034/326034 [==============================] - 7s 21us/step - loss: 0.3153 - acc: 0.8851
Epoch 4/20
326034/326034 [==============================] - 7s 21us/step - loss: 0.3076 - acc: 0.8867
Epoch 5/20
326034/326034 [==============================] - 7s 20us/step - loss: 0.3017 - acc: 0.8878
Epoch 6/20
326034/326034 [==============================] - 7s 22us/step - loss: 0.2971 - acc: 0.8891
Epoch 7/20
326034/326034 [==============================] - 7s 20us/step - loss: 0.2933 - acc: 0.8908
Epoch 8/20
326034/326034 [==============================] - 6s 19us/step - loss: 0.2901 - acc: 0.8924
Epoch 9/20
326034/326034 [==============================] - 6s 19us/step - loss: 0.2874 - acc: 0.8942
Epoch 10/20
326034/326034 [==============================] - 6s 19us/step - loss: 0.2851 - acc: 0.8955
Epoch 11/20
326034/326034 [==============================] - 6s 20us/step - loss: 0.2831 - acc: 0.8965
Epoch 12/20
326034/326034 [==============================] - 6s 20us/step - loss: 0.2813 - acc: 0.8970
Epoch 13/20
326034/326034 [==============================] - 7s 20us/step - loss: 0.2798 - acc: 0.8975
Epoch 14/20
326034/326034 [==============================] - 7s 20us/step - loss: 0.2784 - acc: 0.8980
Epoch 15/20
326034/326034 [==============================] - 7s 20us/step - loss: 0.2771 - acc: 0.8985
Epoch 16/20
326034/326034 [==============================] - 7s 20us/step - loss: 0.2760 - acc: 0.8989
Epoch 17/20
326034/326034 [==============================] - 6s 20us/step - loss: 0.2749 - acc: 0.9005
Epoch 18/20
326034/326034 [==============================] - 6s 20us/step - loss: 0.2740 - acc: 0.9020
Epoch 19/20
326034/326034 [==============================] - 7s 20us/step - loss: 0.2731 - acc: 0.9026
Epoch 20/20
326034/326034 [==============================] - 7s 20us/step - loss: 0.2723 - acc: 0.9035
06/27/2018 08:29:27 PM __main__     INFO     Predicting test dataset... shallow
06/27/2018 08:29:38 PM __main__     INFO     AUC = [0.7590635569352043]
06/27/2018 08:29:38 PM __main__     INFO     Plotting results for shallow model @ data\shallowmodel_timesplit
06/27/2018 08:30:48 PM __main__     INFO     Constructing model - deep
06/27/2018 08:30:50 PM __main__     INFO     Constructed model:
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_7 (Dense)              (None, 128)               384128
_________________________________________________________________
batch_normalization_5 (Batch (None, 128)               512
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0
_________________________________________________________________
dropout_5 (Dropout)          (None, 128)               0
_________________________________________________________________
dense_8 (Dense)              (None, 64)                8256
_________________________________________________________________
batch_normalization_6 (Batch (None, 64)                256
_________________________________________________________________
activation_6 (Activation)    (None, 64)                0
_________________________________________________________________
dropout_6 (Dropout)          (None, 64)                0
_________________________________________________________________
dense_9 (Dense)              (None, 64)                4160
_________________________________________________________________
batch_normalization_7 (Batch (None, 64)                256
_________________________________________________________________
activation_7 (Activation)    (None, 64)                0
_________________________________________________________________
dropout_7 (Dropout)          (None, 64)                0
_________________________________________________________________
dense_10 (Dense)             (None, 32)                2080
_________________________________________________________________
batch_normalization_8 (Batch (None, 32)                128
_________________________________________________________________
activation_8 (Activation)    (None, 32)                0
_________________________________________________________________
dropout_8 (Dropout)          (None, 32)                0
_________________________________________________________________
dense_11 (Dense)             (None, 1)                 33
=================================================================
Total params: 399,809
Trainable params: 399,233
Non-trainable params: 576
_________________________________________________________________
06/27/2018 08:30:50 PM __main__     INFO     Start training model...
Epoch 1/20
348801/348801 [==============================] - 52s 149us/step - loss: 0.2785 - acc: 0.9056
Epoch 2/20
348801/348801 [==============================] - 29s 82us/step - loss: 0.2268 - acc: 0.9234
Epoch 3/20
348801/348801 [==============================] - 29s 82us/step - loss: 0.2107 - acc: 0.9295
Epoch 4/20
348801/348801 [==============================] - 28s 80us/step - loss: 0.2000 - acc: 0.9326
Epoch 5/20
348801/348801 [==============================] - 29s 82us/step - loss: 0.1928 - acc: 0.9348
Epoch 6/20
348801/348801 [==============================] - 28s 81us/step - loss: 0.1859 - acc: 0.9369
Epoch 7/20
348801/348801 [==============================] - 28s 80us/step - loss: 0.1792 - acc: 0.9388
Epoch 8/20
348801/348801 [==============================] - 28s 81us/step - loss: 0.1736 - acc: 0.9406
Epoch 9/20
348801/348801 [==============================] - 28s 80us/step - loss: 0.1680 - acc: 0.9423
Epoch 10/20
348801/348801 [==============================] - 28s 80us/step - loss: 0.1629 - acc: 0.9441
Epoch 11/20
348801/348801 [==============================] - 29s 82us/step - loss: 0.1576 - acc: 0.9454
Epoch 12/20
348801/348801 [==============================] - 31s 89us/step - loss: 0.1530 - acc: 0.9465
Epoch 13/20
348801/348801 [==============================] - 29s 82us/step - loss: 0.1480 - acc: 0.9484
Epoch 14/20
348801/348801 [==============================] - 28s 80us/step - loss: 0.1429 - acc: 0.9498
Epoch 15/20
348801/348801 [==============================] - 28s 80us/step - loss: 0.1386 - acc: 0.9512
Epoch 16/20
348801/348801 [==============================] - 29s 82us/step - loss: 0.1335 - acc: 0.9528
Epoch 17/20
348801/348801 [==============================] - 28s 81us/step - loss: 0.1282 - acc: 0.9551
Epoch 18/20
348801/348801 [==============================] - 29s 83us/step - loss: 0.1244 - acc: 0.9557
Epoch 19/20
348801/348801 [==============================] - 34s 98us/step - loss: 0.1200 - acc: 0.9569
Epoch 20/20
348801/348801 [==============================] - 29s 84us/step - loss: 0.1153 - acc: 0.9586
06/27/2018 08:40:52 PM __main__     INFO     Predicting test dataset... deep
06/27/2018 08:41:06 PM __main__     INFO     AUC = [0.9469311768130603]
06/27/2018 08:41:06 PM __main__     INFO     Plotting results for deep model @ data\deepmodel_randsplit
06/27/2018 08:41:07 PM __main__     INFO     Constructing model - shallow
06/27/2018 08:41:07 PM __main__     INFO     Constructed model:
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_12 (Dense)             (None, 1)                 3001
=================================================================
Total params: 3,001
Trainable params: 3,001
Non-trainable params: 0
_________________________________________________________________
06/27/2018 08:41:07 PM __main__     INFO     Start training model...
Epoch 1/20
348801/348801 [==============================] - 17s 49us/step - loss: 0.3274 - acc: 0.8919
Epoch 2/20
348801/348801 [==============================] - 9s 25us/step - loss: 0.2749 - acc: 0.9052
Epoch 3/20
348801/348801 [==============================] - 8s 22us/step - loss: 0.2630 - acc: 0.9070
Epoch 4/20
348801/348801 [==============================] - 8s 22us/step - loss: 0.2557 - acc: 0.9093
Epoch 5/20                                                                                                                          
348801/348801 [==============================] - 7s 21us/step - loss: 0.2504 - acc: 0.9105
Epoch 6/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2462 - acc: 0.9106
Epoch 7/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2427 - acc: 0.9109
Epoch 8/20                                                                                                                          
348801/348801 [==============================] - 7s 20us/step - loss: 0.2397 - acc: 0.9120
Epoch 9/20
348801/348801 [==============================] - 7s 21us/step - loss: 0.2372 - acc: 0.9128
Epoch 10/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2350 - acc: 0.9135
Epoch 11/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2331 - acc: 0.9144
Epoch 12/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2314 - acc: 0.9163
Epoch 13/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2299 - acc: 0.9174
Epoch 14/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2286 - acc: 0.9192
Epoch 15/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2273 - acc: 0.9199
Epoch 16/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2262 - acc: 0.9202
Epoch 17/20
348801/348801 [==============================] - 7s 21us/step - loss: 0.2252 - acc: 0.9205
Epoch 18/20
348801/348801 [==============================] - 7s 21us/step - loss: 0.2243 - acc: 0.9209
Epoch 19/20
348801/348801 [==============================] - 7s 20us/step - loss: 0.2235 - acc: 0.9212
Epoch 20/20
348801/348801 [==============================] - 7s 21us/step - loss: 0.2227 - acc: 0.9214
06/27/2018 08:43:43 PM __main__     INFO     Predicting test dataset... shallow
06/27/2018 08:43:50 PM __main__     INFO     AUC = [0.8844793625316977]
06/27/2018 08:43:50 PM __main__     INFO     Plotting results for shallow model @ data\shallowmodel_randsplit
06/27/2018 08:43:52 PM __main__     INFO     Plotting all results...
06/27/2018 08:43:54 PM __main__     INFO     Done!